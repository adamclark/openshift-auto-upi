- name: Download aws client archive file
  include_tasks: download_file.yml
  vars:
    name: aws client installer
    url: '{{ aws_client.archive_url }}'
    dest: '{{ builder.install_bin_dir }}/{{ aws_client.archive_name }}'
    checksum: ''

- name: Extract aws client installer
  unarchive:
    src: '{{ builder.install_bin_dir }}/{{ aws_client.archive_name }}'
    dest: '{{ builder.install_bin_dir }}'
    creates: '{{ builder.install_bin_dir }}/awscli-bundle/install'

- name: Install aws client
  command: |
    {{ builder.install_bin_dir }}/awscli-bundle/install \
      --install-dir  {{ builder.install_bin_dir }}/awscli-install \
      --bin-location {{ builder.install_bin_dir }}/aws
  args:
    creates: '{{ builder.install_bin_dir }}/aws'
